{"remainingRequest":"/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/babel-loader/lib/index.js!/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/src/views/fan/fan_review/Dialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/src/views/fan/fan_review/Dialog.vue","mtime":1735999382488},{"path":"/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/cache-loader/dist/cjs.js","mtime":1735892181475},{"path":"/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/babel-loader/lib/index.js","mtime":1735892181655},{"path":"/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/cache-loader/dist/cjs.js","mtime":1735892181475},{"path":"/home/zerohua/application/FrontEnd/tset/stu_manage_front-main/node_modules/vue-loader/lib/index.js","mtime":1735892182047}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IHsgYWRkQWxidW1SZXZpZXcsIHJhdGVBbGJ1bSB9IGZyb20gIkAvYXBpL3JlcXVlc3QiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIlJldmlld0RpYWxvZyIsCiAgcHJvcHM6IHsKICAgIGRpYWxvZ0VkaXRWaXNpYmxlOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdDogZnVuY3Rpb24gX2RlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHt9OwogICAgICB9CiAgICB9LAogICAgcmV2aWV3SW5mbzogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIGRlZmF1bHQ6IGZ1bmN0aW9uIF9kZWZhdWx0KCkgewogICAgICAgIHJldHVybiB7fTsKICAgICAgfQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgY2hpbGRDbG9zZTogZnVuY3Rpb24gY2hpbGRDbG9zZSgpIHsKICAgICAgdGhpcy5kaWFsb2dFZGl0VmlzaWJsZS52YWx1ZSA9IGZhbHNlOwogICAgfSwKICAgIC8vIOaPkOS6pOihqOWNlQogICAgc3VibWl0Rm9ybTogZnVuY3Rpb24gc3VibWl0Rm9ybShmb3JtTmFtZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdGhpcy4kcmVmc1tmb3JtTmFtZV0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgaWYgKHZhbGlkKSB7CiAgICAgICAgICB2YXIgZmFuSWQgPSBfdGhpcy4kc3RvcmUuc3RhdGUuZmFuSWQ7CiAgICAgICAgICB2YXIgYWxidW1JZCA9IF90aGlzLnJldmlld0luZm8uQWxidW1JRDsKICAgICAgICAgIHZhciBjb21tZW50ID0gX3RoaXMucmV2aWV3SW5mby5Db21tZW50OwogICAgICAgICAgdmFyIHJhdGluZyA9IF90aGlzLnJldmlld0luZm8uUmF0aW5nOwogICAgICAgICAgYWRkQWxidW1SZXZpZXcoZmFuSWQsIGFsYnVtSWQsIHsKICAgICAgICAgICAgQ29tbWVudDogY29tbWVudAogICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJhdGVBbGJ1bShmYW5JZCwgYWxidW1JZCwgewogICAgICAgICAgICAgIFJhdGluZzogcmF0aW5nCiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICLor4TorrrmiJDlip8iLAogICAgICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiCiAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIF90aGlzLiRlbWl0KCJ1cGRhdGVSZXZpZXciLCBfdGhpcy5yZXZpZXdJbmZvKTsKCiAgICAgICAgICAgICAgX3RoaXMuY2hpbGRDbG9zZSgpOwogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgX3RoaXMuJG1lc3NhZ2UuZXJyb3IoIuivhOWIhuWksei0pSEiKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgIF90aGlzLiRtZXNzYWdlLmVycm9yKCLor4TorrrlpLHotKUhIik7CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc29sZS5sb2coImVycm9yIHN1Ym1pdCEhIik7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9Cn07"},{"version":3,"sources":["Dialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,SAAA,cAAA,EAAA,SAAA,QAAA,eAAA;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,cADA;AAEA,EAAA,KAAA,EAAA;AACA,IAAA,iBAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAFA,sBAEA;AACA,eAAA,EAAA;AACA;AAJA,KADA;AAOA,IAAA,UAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAFA,sBAEA;AACA,eAAA,EAAA;AACA;AAJA;AAPA,GAFA;AAgBA,EAAA,OAAA,EAAA;AACA,IAAA,UADA,wBACA;AACA,WAAA,iBAAA,CAAA,KAAA,GAAA,KAAA;AACA,KAHA;AAIA;AACA,IAAA,UALA,sBAKA,QALA,EAKA;AAAA;;AACA,WAAA,KAAA,CAAA,QAAA,EAAA,QAAA,CAAA,UAAA,KAAA,EAAA;AACA,YAAA,KAAA,EAAA;AACA,cAAA,KAAA,GAAA,KAAA,CAAA,MAAA,CAAA,KAAA,CAAA,KAAA;AACA,cAAA,OAAA,GAAA,KAAA,CAAA,UAAA,CAAA,OAAA;AACA,cAAA,OAAA,GAAA,KAAA,CAAA,UAAA,CAAA,OAAA;AACA,cAAA,MAAA,GAAA,KAAA,CAAA,UAAA,CAAA,MAAA;AAEA,UAAA,cAAA,CAAA,KAAA,EAAA,OAAA,EAAA;AAAA,YAAA,OAAA,EAAA;AAAA,WAAA,CAAA,CACA,IADA,CACA,YAAA;AACA,YAAA,SAAA,CAAA,KAAA,EAAA,OAAA,EAAA;AAAA,cAAA,MAAA,EAAA;AAAA,aAAA,CAAA,CACA,IADA,CACA,YAAA;AACA,cAAA,KAAA,CAAA,QAAA,CAAA;AAAA,gBAAA,OAAA,EAAA,MAAA;AAAA,gBAAA,IAAA,EAAA;AAAA,eAAA;;AACA,cAAA,KAAA,CAAA,KAAA,CAAA,cAAA,EAAA,KAAA,CAAA,UAAA;;AACA,cAAA,KAAA,CAAA,UAAA;AACA,aALA,EAMA,KANA,CAMA,UAAA,GAAA,EAAA;AACA,cAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,OAAA;AACA,aARA;AASA,WAXA,EAYA,KAZA,CAYA,UAAA,GAAA,EAAA;AACA,YAAA,KAAA,CAAA,QAAA,CAAA,KAAA,CAAA,OAAA;AACA,WAdA;AAeA,SArBA,MAqBA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,gBAAA;AACA,iBAAA,KAAA;AACA;AACA,OA1BA;AA2BA;AAjCA;AAhBA,CAAA","sourcesContent":["<template>\n  <div>\n    <!-- 评论弹窗 -->\n    <el-dialog\n      :visible.sync=\"dialogEditVisible.value\"\n      @close=\"childClose\"\n      width=\"30%\"\n    >\n      <el-form :model=\"reviewInfo\" ref=\"reviewInfo\" label-width=\"100px\">\n        <el-form-item label=\"专辑ID\">\n          <el-input v-model=\"reviewInfo.AlbumID\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"评论内容\">\n          <el-input type=\"textarea\" v-model=\"reviewInfo.Comment\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"评分\">\n          <el-input v-model=\"reviewInfo.Rating\"></el-input>\n        </el-form-item>\n        <el-form-item>\n          <el-button type=\"primary\" @click=\"submitForm('reviewInfo')\"\n            >提交</el-button\n          >\n        </el-form-item>\n      </el-form>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { addAlbumReview, rateAlbum } from \"@/api/request\";\n\nexport default {\n  name: \"ReviewDialog\",\n  props: {\n    dialogEditVisible: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n    reviewInfo: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  methods: {\n    childClose() {\n      this.dialogEditVisible.value = false;\n    },\n    // 提交表单\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          const fanId = this.$store.state.fanId;\n          const albumId = this.reviewInfo.AlbumID;\n          const comment = this.reviewInfo.Comment;\n          const rating = this.reviewInfo.Rating;\n\n          addAlbumReview(fanId, albumId, { Comment: comment })\n            .then(() => {\n              rateAlbum(fanId, albumId, { Rating: rating })\n                .then(() => {\n                  this.$message({ message: \"评论成功\", type: \"success\" });\n                  this.$emit(\"updateReview\", this.reviewInfo);\n                  this.childClose();\n                })\n                .catch((err) => {\n                  this.$message.error(\"评分失败!\");\n                });\n            })\n            .catch((err) => {\n              this.$message.error(\"评论失败!\");\n            });\n        } else {\n          console.log(\"error submit!!\");\n          return false;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.el-form-item {\n  margin-bottom: 20px;\n}\n</style>"],"sourceRoot":"src/views/fan/fan_heLikes/FanAttendConcert"}]}